{% extends 'base.html' %}

{% block content %}
    <h1>Heyyo this is home.</h1>
    <a href="/create_event">Create Event</a>
    {% if not user %} <!-- TODO This is not working -->
        <h1> You have not logged in </h1>
        <a href="/login">Log In</a>
        <a href="/signup">Sign Up</a>
    {% endif %}
    <!-- TODO need to add signout button when logged in -->
    {% if messages %}
        <ul>
            {% for message in messages %}
                <li>
                    {{ message }}
                </li>
            {% endfor %}
        </ul>
    {% endif %}
    {% for event in events %}
        <h2>{{event.name}}</h2>
        <p>start date: {{event.start_date}} <br>
        finish date: {{event.finish_date}} <br>
        created by: {{event.created_by.full_name}} <br>
        users attending: {{event.users_attending.all.count}} <br>
        description: {{event.details}}</p>
        <form action="/attend_event/" method="post">
            {% csrf_token %}
            <input type="hidden" name="event_id" value="{{event.id}}">
            {% if event.created_by.id != user.id and user not in event.users_attending.all %}
                <button type="submit">Attend Event</button>
            {% else %}
                <button type="submit" disabled>Attend Event</button>
            {% endif %}
        </form>
    {% endfor %}
{% endblock %}